<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>English Master Kids - ç©©å®šä¿®æ­£ç‰ˆ v2.3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { 
            -webkit-touch-callout: none; 
            -webkit-user-select: none; 
            overscroll-behavior: none;
            font-family: 'system-ui', -apple-system, sans-serif;
        }
        .correct-anim { animation: pop 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(0.5); opacity: 0; } 60% { transform: scale(1.1); } 100% { transform: scale(1); opacity: 1; } }
        
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .mic-wave span {
            display: inline-block;
            width: 4px;
            height: 10px;
            background-color: white;
            border-radius: 2px;
            animation: wave 1s infinite ease-in-out;
            margin: 0 2px;
        }
        .mic-wave span:nth-child(1) { animation-delay: 0.1s; height: 15px; }
        .mic-wave span:nth-child(2) { animation-delay: 0.2s; height: 25px; }
        .mic-wave span:nth-child(3) { animation-delay: 0.3s; height: 15px; }
        @keyframes wave { 0%, 100% { transform: scaleY(1); } 50% { transform: scaleY(1.5); } }
        
        .backdrop-blur-sm { backdrop-filter: blur(4px); }
    </style>
</head>
<body class="bg-indigo-50 text-slate-800">

    <div id="app" class="min-h-screen flex flex-col items-center max-w-md mx-auto bg-white shadow-2xl min-h-screen relative overflow-hidden">
        <div class="flex items-center justify-center h-screen text-slate-400">
            ç³»çµ±è¼‰å…¥ä¸­...
        </div>
    </div>

    <script>
        // ==========================================
        //  å–®å­—è³‡æ–™åº«
        // ==========================================
        const RAW_WORD_DATA = {
            level1: [
                { en: "[i]", zh: "ã„§ (é•·éŸ³)", ipa: "/i/", note: "å˜´è§’æ‹‰é–‹å¾®ç¬‘ã€‚éŸ³ä¼¼ï¼šä¸€ (é•·éŸ³)", speakText: "E... E... Eat" },
                { en: "[Éª]", zh: "ã„§ (çŸ­éŸ³)", ipa: "/Éª/", note: "å˜´è§’æ”¾é¬†ã€‚éŸ³ä¼¼ï¼šä¸€ (çŸ­ä¿ƒ)", speakText: "Ih... Ih... It" },
                { en: "[e]", zh: "ã„ä¸€ (é›™æ¯éŸ³)", ipa: "/e/", note: "å…ˆå”¸ã„å†æ»‘å‘ä¸€ã€‚éŸ³ä¼¼ï¼šã„ä¸€", speakText: "A... A... Eight" },
                { en: "[É›]", zh: "ã„ (çŸ­éŸ³)", ipa: "/É›/", note: "å˜´å·´å¾®å¼µã€‚éŸ³ä¼¼ï¼šã„", speakText: "Eh... Eh... Egg" },
                { en: "[Ã¦]", zh: "è´è¶éŸ³", ipa: "/Ã¦/", note: "å˜´å¼µå¤§å”¸ã€Œã„ã€ã€‚éŸ³ä¼¼ï¼šæ¢…", speakText: "A... A... Apple" },
                { en: "[É‘]", zh: "å•Š (å¤§å£)", ipa: "/É‘/", note: "å˜´å·´ä¸Šä¸‹æ‹‰å¤§ã€‚éŸ³ä¼¼ï¼šå•Š", speakText: "Ah... Ah... Hot" },
                { en: "[ÊŒ]", zh: "å•Š (çŸ­éŸ³)", ipa: "/ÊŒ/", note: "å˜´å·´å¾®å¼µã€‚éŸ³ä¼¼ï¼šå•Š (çŸ­)", speakText: "Uh... Uh... Up" },
                { en: "[É™]", zh: "ã„œ (è¼•éŸ³)", ipa: "/É™/", note: "å˜´å·´æ”¾é¬†ã€‚éŸ³ä¼¼ï¼šã„œ (è¼•è²)", speakText: "Uh... Uh... About" },
                { en: "[É”]", zh: "å–” (é•·éŸ³)", ipa: "/É”/", note: "å˜´å·´åœ“åœ“çš„ã€‚éŸ³ä¼¼ï¼šå–”", speakText: "Aw... Aw... All" },
                { en: "[o]", zh: "æ­ (é›™æ¯éŸ³)", ipa: "/o/", note: "å…ˆå”¸å–”å†æ»‘å‘ã„¨ã€‚éŸ³ä¼¼ï¼šæ­", speakText: "Oh... Oh... Go" },
                { en: "[u]", zh: "å—š (é•·éŸ³)", ipa: "/u/", note: "å˜´å”‡å˜Ÿåœ“ã€‚éŸ³ä¼¼ï¼šå—š (é•·)", speakText: "Oo... Oo... Food" },
                { en: "[ÊŠ]", zh: "å—š (çŸ­éŸ³)", ipa: "/ÊŠ/", note: "å˜´å·´æ”¾é¬†ä¸€é»ã€‚éŸ³ä¼¼ï¼šå—š (çŸ­)", speakText: "Uh... Uh... Book" },
                { en: "[É]", zh: "å„¿ (é•·éŸ³)", ipa: "/3/ or /É/", note: "æ²èˆŒéŸ³ã€‚éŸ³ä¼¼ï¼šäºŒ (æ²èˆŒ)", speakText: "Er... Er... Bird" },
                { en: "[Éš]", zh: "å„¿ (çŸ­éŸ³)", ipa: "/2/ or /Éš/", note: "è¼•è²æ²èˆŒã€‚éŸ³ä¼¼ï¼šäºŒ (è¼•è²)", speakText: "Er... Er... Sister" },
                { en: "[aÉª]", zh: "ã„", ipa: "/aÉª/", note: "å•Š+ä¸€ã€‚éŸ³ä¼¼ï¼šæ„›", speakText: "I... I... Ice" },
                { en: "[aÊŠ]", zh: "ã„ ", ipa: "/aÊŠ/", note: "å•Š+å—šã€‚éŸ³ä¼¼ï¼šå¥§", speakText: "Ow... Ow... Out" },
                { en: "[É”Éª]", zh: "ã„›ä¸€", ipa: "/É”Éª/", note: "å–”+ä¸€ã€‚éŸ³ä¼¼ï¼šå–”ä¸€", speakText: "Oy... Oy... Boy" }
            ],
            level2: [
                { en: "CH", zh: "CH ç™¼éŸ³", ipa: "/tÊƒ/", note: "æ°£éŸ³ã€‚éŸ³ä¼¼ï¼šå» / åƒ", speakText: "Chuh... Cheese" },
                { en: "SH", zh: "SH ç™¼éŸ³", ipa: "/Êƒ/", note: "æ°£éŸ³ã€‚éŸ³ä¼¼ï¼šå™“", speakText: "Shuh... Sheep" },
                { en: "TH", zh: "TH (ç„¡è²)", ipa: "/Î¸/", note: "å’¬èˆŒå¹æ°£ã€‚éŸ³ä¼¼ï¼šæ–¯", speakText: "Thhh... Thank" },
                { en: "TH", zh: "TH (æœ‰è²)", ipa: "/Ã°/", note: "å’¬èˆŒéœ‡å‹•ã€‚éŸ³ä¼¼ï¼šæ—¥", speakText: "Thzz... This" },
                { en: "PH", zh: "PH ç™¼éŸ³", ipa: "/f/", note: "å’¬ä¸‹å”‡ã€‚éŸ³ä¼¼ï¼šå¤«", speakText: "Fuh... Phone" },
                { en: "WH", zh: "WH ç™¼éŸ³", ipa: "/w/", note: "åœ“å”‡ã€‚éŸ³ä¼¼ï¼šã„¨", speakText: "Wuh... White" },
                { en: "NG", zh: "NG å­—å°¾éŸ³", ipa: "/Å‹/", note: "é¼»éŸ³ã€‚éŸ³ä¼¼ï¼šå—¯", speakText: "Ing... Sing" },
                { en: "CK", zh: "CK å­—å°¾éŸ³", ipa: "/k/", note: "çŸ­ä¿ƒã€‚éŸ³ä¼¼ï¼šå…‹", speakText: "Kuh... Duck" },
                { en: "QU", zh: "QU ç™¼éŸ³", ipa: "/kw/", note: "åœ“å”‡ã€‚éŸ³ä¼¼ï¼šå¤¸", speakText: "Kwuh... Queen" },
                { en: "BL", zh: "BL æ··åˆéŸ³", ipa: "/bl/", note: "éŸ³ä¼¼ï¼šå¸ƒé­¯", speakText: "Buh... Luh... Blue" }
            ],
            level3: [ { en: "Book", zh: "æ›¸", ipa: "/bÊŠk/", note: "oo ç™¼çŸ­éŸ³ /ÊŠ/ã€‚" }, { en: "Cat", zh: "è²“", ipa: "/kÃ¦t/", note: "a ç™¼è´è¶éŸ³ /Ã¦/ã€‚" }, { en: "Dog", zh: "ç‹—", ipa: "/dÉ”g/", note: "o ç™¼çŸ­éŸ³ /É”/ã€‚" }, { en: "Fish", zh: "é­š", ipa: "/fÉªÊƒ/", note: "i ç™¼çŸ­éŸ³ /Éª/ã€‚" } ],
            level4: [ { en: "Family", zh: "å®¶åº­", ipa: "/ËˆfÃ¦mÉ™li/", note: "a ç™¼ /Ã¦/ã€‚" }, { en: "School", zh: "å­¸æ ¡", ipa: "/skul/", note: "oo ç™¼ /u/ã€‚" } ],
            level5: [ { en: "Apple", zh: "è˜‹æœ", ipa: "/ËˆÃ¦pl/", note: "a ç™¼ /Ã¦/ã€‚" }, { en: "Banana", zh: "é¦™è•‰", ipa: "/bÉ™ËˆnÃ¦nÉ™/", note: "a ç™¼ /É™/ èˆ‡ /Ã¦/ã€‚" } ],
            level6: [ { en: "Student", zh: "å­¸ç”Ÿ", ipa: "/Ëˆstudnt/", note: "u ç™¼ /u/ã€‚" }, { en: "Teacher", zh: "è€å¸«", ipa: "/ËˆtitÊƒÉ™r/", note: "ea ç™¼ /i/ã€‚" } ],
            level7: [ { en: "Do you need a hand?", zh: "ä½ éœ€è¦å¹«å¿™å—ï¼Ÿ", ipa: "/nid É™ hÃ¦nd/", note: "é€£è®€ç·´ç¿’ã€‚" }, { en: "How much is this?", zh: "è«‹å•é€™å€‹å¤šå°‘éŒ¢ï¼Ÿ", ipa: "/haÊŠ mÊŒtÊƒ Éªz Ã°Éªs/", note: "é€£è®€ç·´ç¿’ã€‚" } ],
            level8: [ { en: "Go", zh: "å»", ipa: "/goÊŠ/", note: "o ç™¼ /goÊŠ/ã€‚" } ],
            level9: [ { en: "Time", zh: "æ™‚é–“", ipa: "/taÉªm/", note: "i ç™¼ /aÉª/ã€‚" } ],
            level10: [ { en: "Acquire", zh: "ç²å¾—", ipa: "/É™ËˆkwaÉªÉ™r/", note: "ä¸‰éŸ³ç¯€ç·´ç¿’ã€‚" } ]
        };

        const LEVEL_META = [
            { id: 'level1', title: '1. æ¯éŸ³åŸºç¤', desc: 'ç´”æ¯éŸ³ (A, E, I, O, U) ç™¼éŸ³ç·´ç¿’', color: 'bg-yellow-400' },
            { id: 'level2', title: '2. è¤‡åˆå­éŸ³', desc: 'Digraphs & Blends (æ“¬è²å°è®€)', color: 'bg-orange-400' },
            { id: 'level3', title: '3. åœ‹å°å–®å­—', desc: 'åŸºç¤å­—å½™èˆ‡çŸ­æ¯éŸ³ç·´ç¿’', color: 'bg-green-400' },
            { id: 'level4', title: '4. åœ‹ä¸­å–®å­—', desc: 'é€²éšé–±è®€å¸¸ç”¨å­—å½™', color: 'bg-teal-400' },
            { id: 'level5', title: '5. é«˜ä¸€æ ¸å¿ƒ', desc: 'å­¸è¡“å…¥é–€èˆ‡é«˜ä¸­æ ¸å¿ƒå–®å­—', color: 'bg-blue-400' },
            { id: 'level6', title: '6. é«˜äºŒé€²éš', desc: 'æ·±åº¦é–±è®€èˆ‡é€²éšæ‡‰ç”¨', color: 'bg-indigo-400' },
            { id: 'level7', title: '7. æ—¥å¸¸æœƒè©±', desc: 'é“åœ°ç”Ÿæ´»çŸ­å¥èˆ‡é€£è®€ç·´ç¿’', color: 'bg-purple-400' },
            { id: 'level8', title: '8. æ–‡æ³•å‹•è©', desc: 'å¸¸ç”¨å‹•è©è®ŠåŒ–èˆ‡å¥å‹çµæ§‹', color: 'bg-pink-400' },
            { id: 'level9', title: '9. é«˜ä¸‰ç²¾é€²', desc: 'å­¸è¡“ç ”ç©¶èˆ‡æŠ½è±¡æ¦‚å¿µå­—å½™', color: 'bg-rose-400' },
            { id: 'level10', title: '10. å­¸æ¸¬/å¤šç›Š', desc: 'é«˜é »è€ƒè©¦å¿…å‚™å­—å½™', color: 'bg-stone-500' }
        ];

        const QUESTIONS_PER_ROUND = 20;
        let WORD_DATA = {};
        let state = {
            view: 'home',
            currentLevelId: '',
            questions: [],
            currentIndex: 0,
            score: 0,
            status: 'idle',
            transcript: '', 
            feedbackMsg: '',
            timerId: null,
            transitionLock: false,
            speechSupported: !!(window.SpeechRecognition || window.webkitSpeechRecognition),
            ttsSupported: 'speechSynthesis' in window
        };

        // ==========================================
        //  æ ¸å¿ƒåŠŸèƒ½å®šç¾©
        // ==========================================

        function prepareData() {
            WORD_DATA = JSON.parse(JSON.stringify(RAW_WORD_DATA));
            for (const key in WORD_DATA) {
                let list = WORD_DATA[key];
                // æ•¸æ“šè‡ªå‹•æ“´å……ï¼šå¦‚æœå–®å­—ä¸å¤  20 å€‹ï¼Œå‰‡é‡è¤‡å¡«å……
                if (list.length > 0 && list.length < QUESTIONS_PER_ROUND && key !== 'level1') {
                    const originalCount = list.length;
                    for (let i = 0; i < (QUESTIONS_PER_ROUND - originalCount); i++) {
                        list.push(JSON.parse(JSON.stringify(list[i % originalCount])));
                    }
                }
                // é™¤äº† Level 1 ä¿æŒé †åºï¼Œå…¶é¤˜æ‰“äº‚
                if (key !== 'level1') {
                    list.sort(() => 0.5 - Math.random());
                }
            }
        }

        function stopEverything() {
            if (state.timerId) { clearTimeout(state.timerId); state.timerId = null; }
            state.transitionLock = false;
            try { window.speechSynthesis.cancel(); } catch(e){}
            if (recognition) { try { recognition.abort(); } catch(e){} }
        }

        function speak(text, callback) {
            if (!state.ttsSupported) return;
            window.speechSynthesis.cancel();
            
            const currentQ = state.questions[state.currentIndex];
            let textToSpeak = text;
            if (currentQ && currentQ.en === text && currentQ.speakText) {
                textToSpeak = currentQ.speakText;
            } else {
                textToSpeak = text.replace(/\[|\]/g, "");
            }
            
            const u = new SpeechSynthesisUtterance(textToSpeak);
            u.lang = 'en-US';
            u.rate = 0.8;
            u.onend = () => { if (callback) callback(); };
            
            const voices = window.speechSynthesis.getVoices();
            const enVoice = voices.find(v => v.lang === 'en-US' && v.name.includes('Google')) || voices.find(v => v.lang === 'en-US');
            if(enVoice) u.voice = enVoice;
            window.speechSynthesis.speak(u);
        }

        function evaluate(userSay) {
            if (state.transitionLock) return;
            const currentQ = state.questions[state.currentIndex];
            if (!currentQ) return;

            const normalize = (str) => str.toLowerCase().replace(/[^a-z0-9]/g, "");
            const targetClean = normalize(currentQ.en);
            const userClean = normalize(userSay);

            let isCorrect = (state.currentLevelId === 'level1' || state.currentLevelId === 'level2') 
                ? (userSay.trim().length > 0)
                : (userClean && (userClean === targetClean || userClean.includes(targetClean)));

            if (isCorrect) {
                state.status = 'success';
                state.score += 5; 
                state.feedbackMsg = `Correct!`;
                state.transitionLock = true;
                render();
                speak(currentQ.en);
                state.timerId = setTimeout(() => {
                    state.transitionLock = false;
                    nextQuestion();
                }, 1800);
            } else {
                state.status = 'fail';
                state.feedbackMsg = `è½åˆ°: "${userSay}"`;
                render();
                speak(currentQ.en);
            }
        }

        function startGame(levelId) {
            stopEverything();
            const allWords = WORD_DATA[levelId];
            if (!allWords || allWords.length === 0) return;

            state.questions = (levelId === 'level1') ? [...allWords] : [...allWords].slice(0, QUESTIONS_PER_ROUND);
            state.currentLevelId = levelId;
            state.currentIndex = 0;
            state.score = 0;
            state.view = 'game';
            state.status = 'idle';
            state.transcript = '';
            state.feedbackMsg = '';
            render();
            state.timerId = setTimeout(() => speak(state.questions[0].en), 500);
        }

        function nextQuestion() {
            if (state.status === 'success') {
                state.transitionLock = false;
            }
            
            stopEverything(); 
            
            if (state.currentIndex < state.questions.length - 1) {
                state.currentIndex++;
                state.status = 'idle';
                state.transcript = '';
                state.feedbackMsg = '';
                render();
                state.timerId = setTimeout(() => {
                    if (state.view === 'game') speak(state.questions[state.currentIndex].en);
                }, 300);
            } else {
                state.view = 'result';
                render();
            }
        }

        function goHome() {
            stopEverything();
            state.view = 'home';
            render();
        }

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = null;

        function initSTT() {
            if (SpeechRecognition) {
                recognition = new SpeechRecognition();
                recognition.lang = 'en-US';
                recognition.onstart = () => {
                    state.status = 'listening';
                    state.transcript = '';
                    state.feedbackMsg = 'è«‹ç™¼éŸ³...';
                    render();
                };
                recognition.onresult = (event) => {
                    const result = event.results[0][0].transcript;
                    state.transcript = result;
                    evaluate(result);
                };
                recognition.onerror = (e) => {
                    state.status = 'idle'; 
                    state.feedbackMsg = (e.error === 'no-speech') ? 'æ²’è½åˆ°è²éŸ³' : 'è¾¨è­˜éŒ¯èª¤';
                    render();
                };
            }
        }

        function initTTS() {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.getVoices();
            }
        }

        function render() {
            const app = document.getElementById('app');
            let html = '';

            if (state.view === 'home') {
                html = `
                    <div class="w-full p-6 pb-20 fade-in">
                        <header class="mb-6 text-center">
                            <h1 class="text-3xl font-black text-indigo-600 mb-1">English Master</h1>
                            <p class="text-sm text-slate-500">ç©©å®šä¿®æ­£ç‰ˆ v2.3</p>
                        </header>
                        <div class="grid gap-4">
                            ${LEVEL_META.map((lvl) => {
                                return `
                                    <button onclick="startGame('${lvl.id}')" class="relative overflow-hidden rounded-2xl shadow-md bg-white border border-slate-100 transition-transform active:scale-95 text-left">
                                        <div class="${lvl.color} p-4 text-white">
                                            <div class="font-bold text-lg">${lvl.title}</div>
                                            <div class="text-xs opacity-90">${lvl.desc}</div>
                                        </div>
                                        <div class="p-3 flex justify-between items-center text-slate-500 text-sm">
                                            <span>é–‹å§‹æ¸¬é©— (å…± ${lvl.id==='level1'?RAW_WORD_DATA[lvl.id].length:20} é¡Œ)</span>
                                            <i data-lucide="mic" class="w-5 h-5"></i>
                                        </div>
                                    </button>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            } else if (state.view === 'game') {
                const q = state.questions[state.currentIndex];
                const isListening = state.status === 'listening';
                let cardClass = "border-slate-100 shadow-lg";
                if (isListening) cardClass = "border-rose-400 ring-4 ring-rose-50 shadow-xl";
                if (state.status === 'success') cardClass = "border-green-400 bg-green-50 correct-anim";
                if (state.status === 'fail') cardClass = "border-red-300 bg-red-50";

                html = `
                    <div class="w-full h-full flex flex-col p-6 fade-in">
                        <div class="flex justify-between items-center mb-4">
                            <button onclick="goHome()" class="p-2 rounded-full bg-slate-100"><i data-lucide="arrow-left"></i></button>
                            <div class="font-bold text-slate-400">ç¬¬ ${state.currentIndex + 1} / ${state.questions.length} é¡Œ</div>
                            <div class="bg-yellow-100 text-yellow-600 px-3 py-1 rounded-full font-bold text-sm">${state.score} åˆ†</div>
                        </div>
                        <div class="relative bg-white rounded-3xl p-6 mb-6 border-2 transition-all ${cardClass} flex flex-col items-center justify-center min-h-[320px]">
                            <div class="text-5xl font-black text-slate-800 mb-2 text-center break-words leading-tight w-full">${q.en}</div>
                            <div class="text-indigo-400 font-mono text-xl mb-2 font-bold bg-indigo-50 px-3 py-1 rounded-lg">${q.ipa || ''}</div>
                            <div class="text-lg text-slate-400 font-medium mb-6">${q.zh}</div>
                            <div class="bg-yellow-50 border border-yellow-100 p-4 rounded-xl text-sm text-yellow-800 w-full text-left mb-4 shadow-sm">
                                <div class="font-bold text-yellow-600 mb-1 flex items-center gap-1"><i data-lucide="lightbulb" class="w-4 h-4"></i> ç™¼éŸ³æŠ€å·§ï¼š</div>
                                ${q.note || 'è«‹è½å–®å­—ç™¼éŸ³å¾Œè·Ÿè®€ã€‚'}
                            </div>
                            <div class="h-6">
                                ${isListening ? `<div class="mic-wave flex gap-1"><span></span><span></span><span></span></div>` : `<div class="text-sm font-bold ${state.status==='success'?'text-green-600':'text-red-500'}">${state.feedbackMsg}</div>`}
                            </div>
                        </div>
                        <div class="flex items-center justify-center gap-8 mb-6">
                            <button onclick="speak('${q.en}')" class="w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center transition-colors active:bg-slate-200"><i data-lucide="volume-2"></i></button>
                            <button onclick="try{recognition.start()}catch(e){}" class="w-24 h-24 rounded-full flex items-center justify-center bg-indigo-600 text-white shadow-2xl transition-transform active:scale-90 ${isListening?'bg-rose-500':''}"><i data-lucide="mic" class="w-10 h-10"></i></button>
                        </div>
                        <button onclick="nextQuestion()" class="w-full py-3 bg-slate-100 text-slate-400 rounded-full font-bold hover:bg-slate-200 flex items-center justify-center gap-2">
                            è·³éæœ¬é¡Œ <i data-lucide="skip-forward" class="w-4 h-4"></i>
                        </button>
                    </div>
                `;
            } else if (state.view === 'result') {
                html = `
                    <div class="w-full h-full flex flex-col items-center justify-center p-8 text-center fade-in">
                        <div class="text-8xl mb-6">ğŸ†</div>
                        <h2 class="text-3xl font-black mb-2">æ¸¬é©—å®Œæˆï¼</h2>
                        <div class="bg-white border-2 border-slate-100 w-full rounded-2xl p-8 mb-8">
                            <div class="text-slate-400 text-sm mb-1">æœ€çµ‚å¾—åˆ†</div>
                            <div class="text-7xl font-black text-indigo-500">${state.score}</div>
                        </div>
                        <button onclick="goHome()" class="w-full bg-indigo-600 text-white py-4 rounded-xl font-bold">å›åˆ°é¸å–®</button>
                    </div>
                `;
            }

            app.innerHTML = html;
            lucide.createIcons();
            
            window.nextQuestion = nextQuestion;
            window.startGame = startGame;
            window.goHome = goHome;
            window.speak = speak;
        }

        window.onload = function() {
            prepareData();
            initTTS();
            initSTT();
            render();
        };

    </script>
</body>
</html>